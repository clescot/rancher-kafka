kafkaconfig:
  image: clescot/rancher-kafka-config:31
  net: 'container:kafka'

kafkadata:
  net: none
  volumes:
    - /data
  command: /bin/true

kafka:
  labels:
#   test selecting host based on labels
    io.rancher.scheduler.affinity:host_label: kafka=true
#   only one container per host
    io.rancher.scheduler.affinity:container_label_ne: io.rancher.stack_service.name=$${stack_name}/$${service_name}
#   we need to have kafka-config
    io.rancher.sidekicks: kafkaconfig,kafkadata

  image: clescot/rancher-kafka:16
  volumes_from: 
   - kafkaconfig,kafkadata

  ports:
#  kafka message port
#   - "9092:9092"
    - "9092"
#  JMX port
   - "7203"
#- "7203:7203"

  environment:
   - ENABLE_JMX=true
   - auto_leader_rebalance=true
   - auto_create_topics_enable=true
   - default_replication_factor=3
   - accessible_from_public_ip=false
   - compression_type="producer"
   - delete_topic_enable=true
   - port=9092
   - default_number_of_partitions=12
   - default_log_retention_hours=168
   - log_cleaner_enabled=true
